<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="radix" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

  <!--radix_placeholder_meta_tags-->
<title>The Mockup Blog: A Gentle Guide to Tidy Statistics in R</title>

<meta property="description" itemprop="description" content="Working your way through a basic analysis"/>


<!--  https://schema.org/Article -->
<meta property="article:published" itemprop="datePublished" content="2018-03-16"/>
<meta property="article:created" itemprop="dateCreated" content="2018-03-16"/>
<meta name="article:author" content="Thomas Mock"/>

<!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
<meta property="og:title" content="The Mockup Blog: A Gentle Guide to Tidy Statistics in R"/>
<meta property="og:type" content="article"/>
<meta property="og:description" content="Working your way through a basic analysis"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:site_name" content="The Mockup Blog"/>

<!--  https://dev.twitter.com/cards/types/summary -->
<meta property="twitter:card" content="summary"/>
<meta property="twitter:title" content="The Mockup Blog: A Gentle Guide to Tidy Statistics in R"/>
<meta property="twitter:description" content="Working your way through a basic analysis"/>

<!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

<script type="text/json" id="radix-rmarkdown-metadata">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","author","date","output"]}},"value":[{"type":"character","attributes":{},"value":["A Gentle Guide to Tidy Statistics in R"]},{"type":"character","attributes":{},"value":["Working your way through a basic analysis"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","url"]}},"value":[{"type":"character","attributes":{},"value":["Thomas Mock"]},{"type":"character","attributes":{},"value":["https://example.com/norajones"]}]}]},{"type":"character","attributes":{},"value":["03-16-2018"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["radix::radix_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained"]}},"value":[{"type":"logical","attributes":{},"value":[false]}]}]}]}
</script>
<!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["a-gentle-guide-to-tidy-statistics-in-r_files/bowser-1.9.3/bowser.min.js","a-gentle-guide-to-tidy-statistics-in-r_files/distill-2.2.21/template.v2.js","a-gentle-guide-to-tidy-statistics-in-r_files/figure-html5/unnamed-chunk-10-1.png","a-gentle-guide-to-tidy-statistics-in-r_files/figure-html5/unnamed-chunk-16-1.png","a-gentle-guide-to-tidy-statistics-in-r_files/figure-html5/unnamed-chunk-33-1.png","a-gentle-guide-to-tidy-statistics-in-r_files/figure-html5/unnamed-chunk-5-1.png","a-gentle-guide-to-tidy-statistics-in-r_files/jquery-1.11.3/jquery.min.js","a-gentle-guide-to-tidy-statistics-in-r_files/webcomponents-2.0.0/webcomponents.js"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->

<script type="application/javascript">

  window.headroom_prevent_pin = false;

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // initialize headroom for banner
    var header = $('header').get(0);
    var headerHeight = header.offsetHeight;
    var headroom = new Headroom(header, {
      onPin : function() {
        if (window.headroom_prevent_pin) {
          window.headroom_prevent_pin = false;
          headroom.unpin();
        }
      }
    });
    headroom.init();
    if(window.location.hash)
      headroom.unpin();
    $(header).addClass('headroom--transition');

    // offset scroll location for banner on hash change
    // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
    window.addEventListener("hashchange", function(event) {
      window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
    });

    // responsive menu
    $('.radix-site-header').each(function(i, val) {
      var topnav = $(this);
      var toggle = topnav.find('.nav-toggle');
      toggle.on('click', function() {
        topnav.toggleClass('responsive');
      });
    });

    // nav dropdowns
    $('.nav-dropbtn').click(function(e) {
      $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
      $(this).parent().siblings('.nav-dropdown')
         .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $("body").click(function(e){
      $('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $(".nav-dropdown").click(function(e){
      e.stopPropagation();
    });
  });
</script>

<style type="text/css">

/* Theme (user-documented overrideables for nav appearance) */

.radix-site-nav {
  color: rgba(255, 255, 255, 0.8);
  background-color: #455a64;
  font-size: 15px;
  font-weight: 300;
}

.radix-site-nav a {
  color: inherit;
  text-decoration: none;
}

.radix-site-nav a:hover {
  color: white;
}

@media print {
  .radix-site-nav {
    display: none;
  }
}

.radix-site-header {

}

.radix-site-footer {

}


/* Site Header */

.radix-site-header {
  width: 100%;
  box-sizing: border-box;
  z-index: 3;
}

.radix-site-header .nav-left {
  display: inline-block;
  margin-left: 8px;
}

@media screen and (max-width: 768px) {
  .radix-site-header .nav-left {
    margin-left: 0;
  }
}


.radix-site-header .nav-right {
  float: right;
  margin-right: 8px;
}

.radix-site-header a,
.radix-site-header .title {
  display: inline-block;
  text-align: center;
  padding: 14px 10px 14px 10px;
}

.radix-site-header .title {
  font-size: 18px;
}

.radix-site-header .logo {
  padding: 0;
}

.radix-site-header .logo img {
  display: none;
  max-height: 20px;
  width: auto;
  margin-bottom: -4px;
}

.radix-site-header .nav-image img {
  max-height: 18px;
  width: auto;
  display: inline-block;
  margin-bottom: -3px;
}



@media screen and (min-width: 1000px) {
  .radix-site-header .logo img {
    display: inline-block;
  }
  .radix-site-header .nav-left {
    margin-left: 20px;
  }
  .radix-site-header .nav-right {
    margin-right: 20px;
  }
  .radix-site-header .title {
    padding-left: 12px;
  }
}


.radix-site-header .nav-toggle {
  display: none;
}

.nav-dropdown {
  display: inline-block;
  position: relative;
}

.nav-dropdown .nav-dropbtn {
  border: none;
  outline: none;
  color: rgba(255, 255, 255, 0.8);
  padding: 16px 10px;
  background-color: transparent;
  font-family: inherit;
  font-size: inherit;
  font-weight: inherit;
  margin: 0;
  margin-top: 1px;
  z-index: 2;
}

.nav-dropdown-content {
  display: none;
  position: absolute;
  background-color: white;
  min-width: 200px;
  border: 1px solid rgba(0,0,0,0.15);
  border-radius: 4px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
  z-index: 1;
  margin-top: 2px;
  white-space: nowrap;
  padding-top: 4px;
  padding-bottom: 4px;
}

.nav-dropdown-content hr {
  margin-top: 4px;
  margin-bottom: 4px;
  border: none;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.nav-dropdown-active {
  display: block;
}

.nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
  color: black;
  padding: 6px 24px;
  text-decoration: none;
  display: block;
  text-align: left;
}

.nav-dropdown-content .nav-dropdown-header {
  display: block;
  padding: 5px 24px;
  padding-bottom: 0;
  text-transform: uppercase;
  font-size: 14px;
  color: #999999;
  white-space: nowrap;
}

.nav-dropdown:hover .nav-dropbtn {
  color: white;
}

.nav-dropdown-content a:hover {
  background-color: #ddd;
  color: black;
}

.nav-right .nav-dropdown-content {
  margin-left: -45%;
  right: 0;
}

@media screen and (max-width: 768px) {
  .radix-site-header a, .radix-site-header .nav-dropdown  {display: none;}
  .radix-site-header a.nav-toggle {
    float: right;
    display: block;
  }
  .radix-site-header .title {
    margin-left: 0;
  }
  .radix-site-header .nav-right {
    margin-right: 0;
  }
  .radix-site-header {
    overflow: hidden;
  }
  .nav-right .nav-dropdown-content {
    margin-left: 0;
  }
}


@media screen and (max-width: 768px) {
  .radix-site-header.responsive {position: relative;}
  .radix-site-header.responsive a.nav-toggle {
    position: absolute;
    right: 0;
    top: 0;
  }
  .radix-site-header.responsive a,
  .radix-site-header.responsive .nav-dropdown {
    display: block;
    text-align: left;
  }
  .radix-site-header.responsive .nav-left,
  .radix-site-header.responsive .nav-right {
    width: 100%;
  }
  .radix-site-header.responsive .nav-dropdown {float: none;}
  .radix-site-header.responsive .nav-dropdown-content {position: relative;}
  .radix-site-header.responsive .nav-dropdown .nav-dropbtn {
    display: block;
    width: 100%;
    text-align: left;
  }
}

/* Site Footer */

.radix-site-footer {
  width: 100%;
  overflow: hidden;
  box-sizing: border-box;
  z-index: 3;
  margin-top: 30px;
  padding-top: 30px;
  padding-bottom: 30px;
  text-align: center;
}

/* Headroom */

d-title {
  padding-top: 6rem;
}

@media print {
  d-title {
    padding-top: 4rem;
  }
}

.headroom {
  z-index: 1000;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
}

.headroom--transition {
  transition: all .4s ease-in-out;
}

.headroom--unpinned {
  top: -100px;
}

.headroom--pinned {
  top: 0;
}

</style>

<link href="../../site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet"/>
<link href="../../site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet"/>
<script src="../../site_libs/headroom-0.9.4/headroom.min.js"></script>
<!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

<style type="text/css">

body {
  background-color: white;
}

.pandoc-table {
  width: 100%;
}

.pandoc-table>caption {
  margin-bottom: 10px;
}

.pandoc-table th:not([align]) {
  text-align: left;
}

.pagedtable-footer {
  font-size: 15px;
}

.html-widget {
  margin-bottom: 2.0em;
}

.l-screen-inset {
  padding-right: 16px;
}

.l-screen .caption {
  margin-left: 10px;
}

.shaded {
  background: rgb(247, 247, 247);
  padding-top: 20px;
  padding-bottom: 20px;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .html-widget {
  margin-bottom: 0;
  border: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .shaded-content {
  background: white;
}

.text-output {
  margin-top: 0;
  line-height: 1.5em;
}

.hidden {
  display: none !important;
}

d-article {
  padding-bottom: 30px;
}

d-appendix {
  padding-top: 30px;
}

d-article>p>img {
  width: 100%;
}

d-article iframe {
  border: 1px solid rgba(0, 0, 0, 0.1);
  margin-bottom: 2.0em;
  width: 100%;
}

figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

/* CSS for table of contents */

.d-toc {
  color: rgba(0,0,0,0.8);
  font-size: 0.8em;
  line-height: 1em;
}

.d-toc-header {
  font-size: 0.6rem;
  font-weight: 400;
  color: rgba(0, 0, 0, 0.5);
  text-transform: uppercase;
  margin-top: 0;
  margin-bottom: 1.3em;
}

.d-toc a {
  border-bottom: none;
}

.d-toc ul {
  padding-left: 0;
}

.d-toc li>ul {
  padding-top: 0.8em;
  padding-left: 16px;
  margin-bottom: 0.6em;
}

.d-toc ul,
.d-toc li {
  list-style-type: none;
}

.d-toc li {
  margin-bottom: 0.9em;
}

.d-toc-separator {
  margin-top: 20px;
  margin-bottom: 2em;
}

.d-article-with-toc {
  border-top: none;
  padding-top: 0;
}



/* Tweak code blocks (note that this CSS is repeated above in an injection
   into the d-code shadow dom) */

d-code {
  overflow-x: auto !important;
}

pre.d-code code.d-code {
  padding-left: 10px;
  font-size: 12px;
  border-left: 2px solid rgba(0,0,0,0.1);
}

pre.text-output {

  font-size: 12px;
  color: black;
  background: none;
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

@media(min-width: 768px) {

d-code {
  overflow-x: visible !important;
}

pre.d-code code.d-code  {
    padding-left: 18px;
    font-size: 14px;
}
pre.text-output {
  font-size: 14px;
}
}

/* Figure */

.figure {
  position: relative;
  margin-bottom: 2.5em;
  margin-top: 1.5em;
}

.figure img {
  width: 100%;
}

.figure .caption {
  color: rgba(0, 0, 0, 0.6);
  font-size: 12px;
  line-height: 1.5em;
}

.figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

.figure .caption a {
  color: rgba(0, 0, 0, 0.6);
}

.figure .caption b,
.figure .caption strong, {
  font-weight: 600;
  color: rgba(0, 0, 0, 1.0);
}



/* Tweak 1000px media break to show more text */

@media(min-width: 1000px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 16px;
  }

  .grid {
    grid-column-gap: 16px;
  }

  d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
  }
  figure .caption, .figure .caption, figure figcaption {
    font-size: 13px;
  }
}

@media(min-width: 1180px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 32px;
  }

  .grid {
    grid-column-gap: 32px;
  }
}


/* Get the citation styles for the appendix (not auto-injected on render since
   we do our own rendering of the citation appendix) */

d-appendix .citation-appendix,
.d-appendix .citation-appendix {
  font-size: 11px;
  line-height: 15px;
  border-left: 1px solid rgba(0, 0, 0, 0.1);
  padding-left: 18px;
  border: 1px solid rgba(0,0,0,0.1);
  background: rgba(0, 0, 0, 0.02);
  padding: 10px 18px;
  border-radius: 3px;
  color: rgba(150, 150, 150, 1);
  overflow: hidden;
  margin-top: -12px;
  white-space: pre-wrap;
  word-wrap: break-word;
}


/* Social footer */

.social_footer {
  margin-top: 30px;
  margin-bottom: 0;
  color: rgba(0,0,0,0.67);
}

.disqus-comments {
  margin-right: 30px;
}

.disqus-comment-count {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  cursor: pointer;
}

#disqus_thread {
  margin-top: 30px;
}

.article-sharing a {
  border-bottom: none;
  margin-right: 8px;
}

.article-sharing a:hover {
  border-bottom: none;
}

.sidebar-section.subscribe {
  font-size: 12px;
  line-height: 1.6em;
}

.subscribe p {
  margin-bottom: 0.5em;
}


.article-footer .subscribe {
  font-size: 15px;
  margin-top: 45px;
}


/* Improve display for browsers without grid (IE/Edge <= 15) */

.downlevel {
  line-height: 1.6em;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  margin: 0;
}

.downlevel .d-title {
  padding-top: 6rem;
  padding-bottom: 1.5rem;
}

.downlevel .d-title h1 {
  font-size: 50px;
  font-weight: 700;
  line-height: 1.1em;
  margin: 0 0 0.5rem;
}

.downlevel .d-title p {
  font-weight: 300;
  font-size: 1.2rem;
  line-height: 1.55em;
  margin-top: 0;
}

.downlevel .d-byline {
  padding-top: 0.8em;
  padding-bottom: 0.8em;
  font-size: 0.8rem;
  line-height: 1.8em;
}

.downlevel .section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
}

.downlevel .d-article {
  font-size: 1.06rem;
  line-height: 1.7em;
  padding-top: 1rem;
  padding-bottom: 2rem;
}


.downlevel .d-appendix {
  padding-left: 0;
  padding-right: 0;
  max-width: none;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.5);
  padding-top: 40px;
  padding-bottom: 48px;
}

.downlevel .footnotes ol {
  padding-left: 13px;
}

.downlevel .base-grid,
.downlevel .distill-header,
.downlevel .d-title,
.downlevel .d-abstract,
.downlevel .d-article,
.downlevel .d-appendix,
.downlevel .distill-appendix,
.downlevel .d-byline,
.downlevel .d-footnote-list,
.downlevel .d-citation-list,
.downlevel .distill-footer,
.downlevel .appendix-bottom,
.downlevel .posts-container {
  padding-left: 40px;
  padding-right: 40px;
}

@media(min-width: 768px) {
  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
  padding-left: 150px;
  padding-right: 150px;
  max-width: 900px;
}
}

.downlevel pre code {
  display: block;
  border-left: 2px solid rgba(0, 0, 0, .1);
  padding: 0 0 0 20px;
  font-size: 14px;
}

.downlevel code, .downlevel pre {
  color: black;
  background: none;
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

</style>

<script type="application/javascript">

function is_downlevel_browser() {
  if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                 window.navigator.userAgent)) {
    return true;
  } else {
    return window.load_distill_framework === undefined;
  }
}

// show body when load is complete
function on_load_complete() {

  // set body to visible
  document.body.style.visibility = 'visible';

  // force redraw for leaflet widgets
  if (window.HTMLWidgets) {
    var maps = window.HTMLWidgets.findAll(".leaflet");
    $.each(maps, function(i, el) {
      var map = this.getMap();
      map.invalidateSize();
      map.eachLayer(function(layer) {
        if (layer instanceof L.TileLayer)
          layer.redraw();
      });
    });
  }

  // trigger 'shown' so htmlwidgets resize
  $('d-article').trigger('shown');
}

function init_distill() {

  init_common();

  // create front matter
  var front_matter = $('<d-front-matter></d-front-matter>');
  $('#distill-front-matter').wrap(front_matter);

  // create d-title
  $('.d-title').changeElementType('d-title');

  // create d-byline
  var byline = $('<d-byline></d-byline>');
  $('.d-byline').replaceWith(byline);

  // create d-article
  var article = $('<d-article></d-article>');
  $('.d-article').wrap(article).children().unwrap();

  // move posts container into article
  $('.posts-container').appendTo($('d-article'));

  // create d-appendix
  $('.d-appendix').changeElementType('d-appendix');

  // create d-bibliography
  var bibliography = $('<d-bibliography></d-bibliography>');
  $('#distill-bibliography').wrap(bibliography);

  // flag indicating that we have appendix items
  var appendix = $('.appendix-bottom').children('h3').length > 0;

  // replace citations with <d-cite>
  $('.citation').each(function(i, val) {
    appendix = true;
    var cites = $(this).attr('data-cites').split(" ");
    var dt_cite = $('<d-cite></d-cite>');
    dt_cite.attr('key', cites.join());
    $(this).replaceWith(dt_cite);
  });
  // remove refs
  $('#refs').remove();

  // replace footnotes with <d-footnote>
  $('.footnote-ref').each(function(i, val) {
    appendix = true;
    var href = $(this).attr('href');
    var id = href.replace('#', '');
    var fn = $('#' + id);
    var fn_p = $('#' + id + '>p');
    fn_p.find('.footnote-back').remove();
    var text = fn_p.html();
    var dtfn = $('<d-footnote></d-footnote>');
    dtfn.html(text);
    $(this).replaceWith(dtfn);
  });
  // remove footnotes
  $('.footnotes').remove();

  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    var id = $(this).attr('id');
    $('.d-toc a[href="#' + id + '"]').parent().remove();
    appendix = true;
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
  });

  // show d-appendix if we have appendix content
  $("d-appendix").css('display', appendix ? 'grid' : 'none');

  // replace code blocks with d-code
  $('pre>code').each(function(i, val) {
    var code = $(this);
    var pre = code.parent();
    var clz = "";
    var language = pre.attr('class');
    if (language) {
      // map unknown languages to "clike" (without this they just dissapear)
      if ($.inArray(language, ["bash", "clike", "css", "go", "html",
                               "javascript", "js", "julia", "lua", "markdown",
                               "markup", "mathml", "python", "svg", "xml"]) == -1)
        language = "clike";
      language = ' language="' + language + '"';
      var dt_code = $('<d-code block' + language + clz + '></d-code>');
      dt_code.text(code.text());
      pre.replaceWith(dt_code);
    } else {
      code.addClass('text-output').unwrap().changeElementType('pre');
    }
  });

  // localize layout chunks to just output
  $('.layout-chunk').each(function(i, val) {

    // capture layout
    var layout = $(this).attr('data-layout');

    // apply layout to markdown level block elements
    var elements = $(this).children().not('d-code, pre.text-output, script');
    elements.each(function(i, el) {
      var layout_div = $('<div class="' + layout + '"></div>');
      if (layout_div.hasClass('shaded')) {
        var shaded_content = $('<div class="shaded-content"></div>');
        $(this).wrap(shaded_content);
        $(this).parent().wrap(layout_div);
      } else {
        $(this).wrap(layout_div);
      }
    });


    // unwrap the layout-chunk div
    $(this).children().unwrap();
  });

  // load distill framework
  load_distill_framework();

  // wait for window.distillRunlevel == 4 to do post processing
  function distill_post_process() {

    if (!window.distillRunlevel || window.distillRunlevel < 4)
      return;

    // hide author/affiliations entirely if we have no authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;
    if (!have_authors)
      $('d-byline').addClass('hidden');

    // table of contents
    if (have_authors) // adjust border if we are in authors
      $('.d-toc').parent().addClass('d-article-with-toc');

    // strip links that point to #
    $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

    // hide elements of author/affiliations grid that have no value
    function hide_byline_column(caption) {
      $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
    }

    // affiliations
    var have_affiliations = false;
    for (var i = 0; i<front_matter.authors.length; ++i) {
      var author = front_matter.authors[i];
      if (author.affiliation !== "&nbsp;") {
        have_affiliations = true;
        break;
      }
    }
    if (!have_affiliations)
      $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

    // published date
    if (!front_matter.publishedDate)
      hide_byline_column("Published");

    // document object identifier
    var doi = $('d-byline').find('h3:contains("DOI")');
    var doi_p = doi.next().empty();
    if (!front_matter.doi) {
      // if we have a citation and valid citationText then link to that
      if ($('#citation').length > 0 && front_matter.citationText) {
        doi.html('Citation');
        $('<a href="#citation"></a>')
          .text(front_matter.citationText)
          .appendTo(doi_p);
      } else {
        hide_byline_column("DOI");
      }
    } else {
      $('<a></a>')
         .attr('href', "https://doi.org/" + front_matter.doi)
         .html(front_matter.doi)
         .appendTo(doi_p);
    }

     // change plural form of authors/affiliations
    if (front_matter.authors.length === 1) {
      var grid = $('.authors-affiliations');
      grid.children('h3:contains("Authors")').text('Author');
      grid.children('h3:contains("Affiliations")').text('Affiliation');
    }

    // inject pre code styles (can't do this with a global stylesheet b/c a shadow root is used)
    $('d-code').each(function(i, val) {
      var style = document.createElement('style');
      style.innerHTML = 'pre code { padding-left: 10px; font-size: 12px; border-left: 2px solid rgba(0,0,0,0.1); } ' +
                        '@media(min-width: 768px) { pre code { padding-left: 18px; font-size: 14px; } }';
      if (this.shadowRoot)
        this.shadowRoot.appendChild(style);
    });

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // clear polling timer
    clearInterval(tid);

    // show body now that everything is ready
    on_load_complete();
  }

  var tid = setInterval(distill_post_process, 50);
  distill_post_process();

}

function init_downlevel() {

  init_common();

   // insert hr after d-title
  $('.d-title').after($('<hr class="section-separator"/>'));

  // check if we have authors
  var front_matter = JSON.parse($("#distill-front-matter").html());
  var have_authors = front_matter.authors && front_matter.authors.length > 0;

  // manage byline/border
  if (!have_authors)
    $('.d-byline').remove();
  $('.d-byline').after($('<hr class="section-separator"/>'));
  $('.d-byline a').remove();

  // remove toc
  $('.d-toc-header').remove();
  $('.d-toc').remove();
  $('.d-toc-separator').remove();

  // move appendix elements
  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
  });


  // inject headers into references and footnotes
  var refs_header = $('<h3></h3>');
  refs_header.text('References');
  $('#refs').prepend(refs_header);

  var footnotes_header = $('<h3></h3');
  footnotes_header.text('Footnotes');
  $('.footnotes').children('hr').first().replaceWith(footnotes_header);

  // move appendix-bottom entries to the bottom
  $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
  $('.appendix-bottom').remove();

  // remove appendix if it's empty
  if ($('.d-appendix').children().length === 0)
    $('.d-appendix').remove();

  // prepend separator above appendix
  $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

  // trim code
  $('pre>code').each(function(i, val) {
    $(this).html($.trim($(this).html()));
  });

  // move posts-container right before article
  $('.posts-container').insertBefore($('.d-article'));

  $('body').addClass('downlevel');

  on_load_complete();
}


function init_common() {

  // jquery plugin to change element types
  (function($) {
    $.fn.changeElementType = function(newType) {
      var attrs = {};

      $.each(this[0].attributes, function(idx, attr) {
        attrs[attr.nodeName] = attr.nodeValue;
      });

      this.replaceWith(function() {
        return $("<" + newType + "/>", attrs).append($(this).contents());
      });
    };
  })(jQuery);

  // prevent underline for linked images
  $('a > img').parent().css({'border-bottom' : 'none'});

  // mark non-body figures created by knitr chunks as 100% width
  $('.layout-chunk').each(function(i, val) {
    var figures = $(this).find('img, .html-widget');
    if ($(this).attr('data-layout') !== "l-body") {
      figures.css('width', '100%');
    } else {
      figures.css('max-width', '100%');
      figures.filter("[width]").each(function(i, val) {
        var fig = $(this);
        fig.css('width', fig.attr('width') + 'px');
      });

    }
  });

  // auto-append index.html to post-preview links in file: protocol
  // and in rstudio ide preview
  $('.post-preview').each(function(i, val) {
    if (window.location.protocol === "file:")
      $(this).attr('href', $(this).attr('href') + "index.html");
  });

  // get rid of index.html references in header
  if (window.location.protocol !== "file:") {
    $('.radix-site-header a[href]').each(function(i,val) {
      $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
    });
  }

  // add class to pandoc style tables
  $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
  $('.kable-table').children('table').addClass('pandoc-table');

  // add figcaption style to table captions
  $('caption').parent('table').addClass("figcaption");

  // initialize posts list
  if (window.init_posts_list)
    window.init_posts_list();

  // implmement disqus comment link
  $('.disqus-comment-count').click(function() {
    window.headroom_prevent_pin = true;
    $('#disqus_thread').toggleClass('hidden');
    if (!$('#disqus_thread').hasClass('hidden')) {
      var offset = $(this).offset();
      $(window).resize();
      $('html, body').animate({
        scrollTop: offset.top - 35
      });
    }
  });
}

document.addEventListener('DOMContentLoaded', function() {
  if (is_downlevel_browser())
    init_downlevel();
  else
    window.addEventListener('WebComponentsReady', init_distill);
});

</script>

<!--/radix_placeholder_distill-->
  <script src="../../site_libs/jquery-1.11.3/jquery.min.js"></script>
  <script src="../../site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="../../site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="../../site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
<!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"A Gentle Guide to Tidy Statistics in R","description":"Working your way through a basic analysis","authors":[{"author":"Thomas Mock","authorURL":"https://example.com/norajones","affiliation":"&nbsp;","affiliationURL":"#"}],"publishedDate":"2018-03-16T00:00:00.000-05:00","citationText":"Mock, 2018"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="radix-site-nav radix-site-header">
<div class="nav-left">
<a href="../../index.html" class="title">The Mockup Blog</a>
</div>
<div class="nav-right">
<a href="../../index.html">Home</a>
<a href="../../about.html">About</a>
<a href="../../index.xml">
<i class="fa fa-rss"></i>
</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>A Gentle Guide to Tidy Statistics in R</h1>
<p>Working your way through a basic analysis</p>
</div>

<div class="d-byline">
  Thomas Mock <a href="https://example.com/norajones" class="uri">https://example.com/norajones</a> 
  
<br/>03-16-2018
</div>

<div class="d-article">
<figure>
<img src="https://i.imgur.com/o6k6Rne.jpg" alt="While data analysis in R can seem intimidating, we will explore how to use it effectively and clearly!" /><figcaption>While data analysis in R can seem intimidating, we will explore how to use it effectively and clearly!</figcaption>
</figure>
<h2 id="introduction">Introduction</h2>
<p>After a great discussion started by Jesse Maegan (<span class="citation" data-cites="kiersi">@kiersi</span>) on Twitter, I decided to post a workthrough of some (fake) experimental treatment data. These data correspond to a new (fake) research drug called AD-x37, a theoretical drug that has been shown to have beneficial outcomes on cognitive decline in mouse models of Alzheimer’s disease. In the current experiment we will be statistically testing whether the drug was effective in reducing cognitive impairment in dementia patients. See the data <a href="https://github.com/jthomasmock/tidy-stats-in-R/blob/master/ad_treatment.xlsx" title="Data for Tidy Stats">HERE</a>.</p>
<p>We will be using MMSE (mini-mental status exam) scores to assess the degree of cognitive impairment. In a real clinical trial, many other variables would be recorded, but for the sake of a straightforward but multi-variate example we will stick to just MMSE.</p>
<figure>
<img src="https://i.imgur.com/YGevPDS.png" alt="Source: Folstein et al, 1975, J Psychiatr Res 12:189–198" /><figcaption>Source: Folstein et al, 1975, J Psychiatr Res 12:189–198</figcaption>
</figure>
<p>We will be working through loading, plotting, analyzing, and saving the outputs of our analysis through the tidyverse, an “opinionated collection of R packages” designed for data analysis. We will limit dependence to two packages: tidyverse and broomwhile using base R for the rest. These two packages dramatically improve the data analysis workflow in my opinion. While other stats-heavy packages provide additional statistical testing, base R has a decent ability to perform statistical analyses out of the box. I will use knitr::kable to generate some html tables for a markdown document, but it is not necessary for the workflow.</p>
<p>Additionally, I will be uploading the <a href="https://github.com/jthomasmock/tidy-stats-in-R/blob/master/ad_treatment.xlsx" title="Data for Tidy Stats">Excel Sheet</a> used in this example, so that you can re-create the workflow on your own. You can simply copy-paste the code seen here and it will run in R. If you would rather see the entire workflow in an R-Markdown document, please see <a href="http://rpubs.com/jtmock/tidy-stats-in-R">here</a>. R Markdown is a document created inside R that allows you to write code, execute it inline, and write comments/notes as you go. You could think of it like being able to write R code inside a basic Word document (but it can do a lot more than that!).</p>
<p>Although you may not be interested in the dataset I have provided, this hopefully provides a clear workflow for you to swap in your data of interest and accomplish a basic analysis!</p>
<h3 id="load-the-tidyverse-broom-and-knitr">Load the tidyverse, broom, and knitr</h3>
<p>Using the <code>library</code> function we will load the <code>tidyverse</code>. If you have never installed it before you can also use the <code>install.packages(&quot;tidyverse&quot;)</code> call to install it for the first time. This package includes <code>ggplot2</code> (graphs), <code>dplyr</code>/<code>tidyr</code> (summary statistics, data manipulation), and <code>readxl</code> (reading excel files) as well as the pipe <code>%&gt;%</code>which will make our code much more readable! We will also load the <code>broom</code> package to tidy up some of our statistical outputs. Lastly we will load <code>knitr</code> for making nice html tables via <code>knitr::kable</code>, but not necessary for simply saving the outputs to Excel.</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
# Load libraries
library(tidyverse)
library(broom)
library(knitr)
library(readxl)</code></pre>
</div>
<p>This will output some message about the packages being loaded and any conflicts of function calls.</p>
<h3 id="loading-the-data">Loading the data</h3>
<p>While I am calling <code>readxl::read_xlsx</code> you could also simply use <code>read_xlsx</code>, but in the interest of transparency, I will be using the full call to begin. The concept of calling a function with the use of <code>::</code> is important as some packages have conflicts in functions, for example multiple packages include the function select and summarize. As such, we can clarify from which package we want R to call our function from, so <code>package::function</code> ! To read more about the concept of “namespace” when calling functions, please look <a href="http://r-pkgs.had.co.nz/namespace.html" title="R Packages">here</a>.</p>
<p><code>readxl</code> is unfortunately a funny case, as installing the <code>tidyverse</code> installs <code>readxl</code>, but <code>readxl</code> is not loaded when loading the <code>tidyverse</code> via a <code>library</code> call. As such we must either load <code>readxl</code> like any other package or call both the package and the name as in <code>readxl::read_xlsx</code>. <code>readxl</code> allows us to read .xls, .xlsx files into R. Alternatively, you could convert your Excel sheet into .csv, which can be read by <code>read_csv()</code>. By using the <code>glimpse</code> function from <code>dplyr</code> we can see how the variables were imported, as well as the first few rows.</p>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>
Observations: 600
Variables: 5
$ age            &lt;int&gt; 80, 85, 82, 80, 83, 79, 82, 79, 80, 79, 80...
$ sex            &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 1, ...
$ health_status  &lt;chr&gt; &quot;Healthy&quot;, &quot;Healthy&quot;, &quot;Healthy&quot;, &quot;Healthy&quot;...
$ drug_treatment &lt;chr&gt; &quot;Placebo&quot;, &quot;Placebo&quot;, &quot;Placebo&quot;, &quot;Placebo&quot;...
$ mmse           &lt;dbl&gt; 24.78988, 24.88192, 25.10903, 24.92636, 23...</code></pre>
</div>
<hr />
<p>We can collect some information about the dataset now. Namely, we have our 3 categorical/factor variables: sex, health_status, and drug_treatment and 1 dependent variable (DV): mmse. We also have age, but importantly it is recorded as a discrete number instead of as a factor (eg as 85 years, instead of old). Thus we can look at age, but we will not use it as a factor in our ANOVA.</p>
<p>Checking the data distribution</p>
<p>We will use our first ggplot2call to create a graph showing the distribution of age. To break down what we are doing, we need to call ggplot, tell it what data to use, and use the aes or <code>aesthetic</code> call to assign the x coordinate. We then add a <code>+</code> which tells ggplot to include the next line of code. The <code>geom_density</code> tells R that we want to make create a density distribution layer and we want to fillit with a blue color! For more info about ggplot2 please go <a href="http://r4ds.had.co.nz/data-visualisation.html">HERE</a> or <a href="http://moderndive.com/3-viz.html">here</a>.</p>
<div class="layout-chunk" data-layout="l-body">
<p><img src="a-gentle-guide-to-tidy-statistics-in-r_files/figure-html5/unnamed-chunk-5-1.png" width="624" /></p>
</div>
<hr />
<p>The graph shows us that age really only goes from 79–85 years, and that there is really not any age over or underrepresented. We can confirm the age ranges by a <code>dplyr::summarize</code> call or by calling <code>range</code> in base R. As a slight aside, we can now talk about using the pipe or <code>%&gt;%</code>. The pipe passes the results or data from the left of it to the right. For more info about the pipe, please see <a href="http://r4ds.had.co.nz/pipes.html">here</a>.</p>
<p>We can read the following code as take <code>raw_df</code> and then summarize it by taking the min and max of the age variable. Now because we started with raw_df R understands we want to take the column age from this dataframe.</p>
<div class="layout-chunk" data-layout="l-body">
<pre><code>
# A tibble: 1 x 2
    min   max
  &lt;dbl&gt; &lt;dbl&gt;
1    79    85</code></pre>
</div>
<p>Alternatively we could use the base R <code>range</code> function, which requires the use of <code>$</code> . The dollar sign indicates that R should use the age column from raw_df. Both of these functions give us the same results, the minimum number and maximum number.</p>
<div class="layout-chunk" data-layout="l-body">
<pre><code>
[1] 79 85</code></pre>
</div>
<p>For more information about using these two syntaxes look <a href="http://www.science.smith.edu/~amcnamara/Syntax-cheatsheet.pdf">here</a> or for cheat sheets look <a href="https://www.rstudio.com/resources/cheatsheets/">here</a>.</p>
<h4 id="what-about-the-experimental-variables-levels">What about the experimental variables levels?</h4>
<p>Now while I am very aware of the variables in this dataframe, you might not be without exploring it! To quickly determine drug_treatment groups, health_status groups and how they interact we can do a table call. By calling it on both drug_treatment and health_status, we get a nice table breaking down how many rows are in each of the variable groups.</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
table(raw_df$drug_treatment, raw_df$health_status)</code></pre>
<pre><code>
           
            Alzheimer&#39;s Healthy
  High Dose         100     100
  Low dose          100     100
  Placebo           100     100</code></pre>
</div>
<hr />
<p>Alternatively we can do the same thing in <code>dplyr</code> with the following code.</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
raw_df %&gt;% 
  group_by(drug_treatment, health_status) %&gt;% 
  count()</code></pre>
<pre><code>
# A tibble: 6 x 3
# Groups:   drug_treatment, health_status [6]
  drug_treatment health_status     n
  &lt;chr&gt;          &lt;chr&gt;         &lt;int&gt;
1 High Dose      Alzheimer&#39;s     100
2 High Dose      Healthy         100
3 Low dose       Alzheimer&#39;s     100
4 Low dose       Healthy         100
5 Placebo        Alzheimer&#39;s     100
6 Placebo        Healthy         100</code></pre>
</div>
<p>Now we know the levels of our variables of interest, and that there are 100 patients per overall treatment group!</p>
<h3 id="data-exploration-of-dependent-variable">Data exploration of dependent variable</h3>
<p>Before running our summary statistics we can actually visualize the range, central tendency and quartiles via a geom_boxplot call.</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
ggplot(data = raw_df, # add the data
       aes(x = drug_treatment, y = mmse, # set x, y coordinates
           color = drug_treatment)) +    # color by treatment
  geom_boxplot() +
  facet_grid(~health_status) # create panes base on health status</code></pre>
<p><img src="a-gentle-guide-to-tidy-statistics-in-r_files/figure-html5/unnamed-chunk-10-1.png" width="624" style="display: block; margin: auto;" /></p>
</div>
<hr />
<p>We have split the data into separate graph facets (or panes) for healthy and Alzheimer’s patients, as well as into groups within each facet by drug treatment. This graph tells us a few things of interest for later. It definitely looks like we have an effect with our (fake) awesome drug! Let’s explore that with descriptive statistics.</p>
<p>While this is an exploratory graph and we don’t necessarily want to “tweak” it to perfection, we can take note that our drug treatment should be ordered Placebo &lt; Low dose &lt; High Dose and we should have Healthy patients presented first, and Alzheimer’s patients second. This is something we can fix in our next section!</p>
<h3 id="summary-statistics">Summary Statistics</h3>
<p>We are looking to generate the mean and standard error for mmse scores, this is useful as a measure of central tendency, and for creating our final publication graphs. We have our categorical variables of sex, drug treatment, and health status. However going back to our glimpse call from earlier, we can see that the data is not ‘coded’ properly. Namely, sex is a <code>dbl</code> (number), without a descriptive name, and health_status/drug_treatment are <code>chr</code> (characters)! These need to be converted into factors!</p>
<div class="layout-chunk" data-layout="l-body">
<pre><code>
Observations: 600
Variables: 5
$ age            &lt;int&gt; 80, 85, 82, 80, 83, 79, 82, 79, 80, 79, 80...
$ sex            &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 1, ...
$ health_status  &lt;chr&gt; &quot;Healthy&quot;, &quot;Healthy&quot;, &quot;Healthy&quot;, &quot;Healthy&quot;...
$ drug_treatment &lt;chr&gt; &quot;Placebo&quot;, &quot;Placebo&quot;, &quot;Placebo&quot;, &quot;Placebo&quot;...
$ mmse           &lt;dbl&gt; 24.78988, 24.88192, 25.10903, 24.92636, 23...</code></pre>
</div>
<hr />
<p>We can use the <code>dplyr::mutate</code> function to tell R we want to change (mutate) the rows within a variable of interest. So we will take the data in the sex, drug_treatment, and health_status columns and convert them from either just numbers or characters into a factor variable! <code>dplyr::mutate</code> can also perform math, and many other interesting things. For more information please see <a href="http://stat545.com/block010_dplyr-end-single-table.html#use-mutate-to-add-new-variables">here</a>.</p>
<p>We will use the <code>mutate</code> function and the base R <code>factor</code> function to convert our variables into the proper factors, and give them labels (for sex) or reorder the levels of the factors.</p>
<p>We need to be REALLY careful to type the labels EXACTLY as they appear in the column or it will replace those misspelled with a NA. For example, did you notice that High Dose has a capital “D” while Low dose has a lower case “d”?</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
sum_df &lt;- raw_df %&gt;% 
            mutate(
              sex = factor(sex, 
                  labels = c(&quot;Male&quot;, &quot;Female&quot;)),
              drug_treatment =  factor(drug_treatment, 
                  levels = c(&quot;Placebo&quot;, &quot;Low dose&quot;, &quot;High Dose&quot;)),
              health_status = factor(health_status, 
                  levels = c(&quot;Healthy&quot;, &quot;Alzheimer&#39;s&quot;))
              )
glimpse(sum_df)</code></pre>
</div>
<p>As powerful as R is, it needs explicit and accurate code input to accomplish the end goals. As such, if we had typed “High dose” it would give an NA, while “High Dose” outputs correctly. We now see age and mmse as dbl (numerics) and sex, health_status, and drug_treatment as factors.</p>
<div class="layout-chunk" data-layout="l-body">
<pre><code>
Observations: 600
Variables: 5
$ age            &lt;int&gt; 80, 85, 82, 80, 83, 79, 82, 79, 80, 79, 80...
$ sex            &lt;fct&gt; Male, Male, Male, Male, Male, Male, Male, ...
$ health_status  &lt;fct&gt; Healthy, Healthy, Healthy, Healthy, Health...
$ drug_treatment &lt;fct&gt; Placebo, Placebo, Placebo, Placebo, Placeb...
$ mmse           &lt;dbl&gt; 24.78988, 24.88192, 25.10903, 24.92636, 23...</code></pre>
</div>
<p>Now that everything is coded properly, we can calculate our mean and standard error (se = standard deviation/square root of number of samples)! We will use the <code>dplyr::group_by</code> to tell R which factors we want to… group by! Then we will create named summaries by first calling <code>dplyr::summarize</code> and then specifying which summaries we want with mmse_mean and mmse_seand the number of samples <code>n()</code>. Lastly we will <code>ungroup</code>, which removes the <code>group_by</code> code from the dataframe.</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
sum_df &lt;- sum_df %&gt;%   
  group_by(sex, health_status, drug_treatment) %&gt;%  
  summarize(mmse_mean = mean(mmse),   
            mmse_se = sd(mmse)/sqrt(n()),
            n_samples = n()) %&gt;%
  ungroup() # ungrouping variable is a good habit to prevent errors</code></pre>
</div>
<hr />
<p>Now we have a nicely formatted dataframe that can be saved to Excel, or used in graphing. We need to indicate what data we are writing (sum_df) and what we want the resulting file to be named (“adx37_sum_stats.csv”).</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
# code to save the table into a .csv Excel file
write.csv(sum_df, &quot;adx37_sum_stats.csv&quot;)</code></pre>
</div>
<hr />
<h3 id="summary-graph">Summary graph</h3>
<p>By calling a ggplot function we can generate a preliminary summary graph.</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
ggplot(data = sum_df, # add the data
       aes(x = drug_treatment,  #set x, y coordinates
           y = mmse_mean,
           group = drug_treatment,  # group by treatment
           color = drug_treatment)) +    # color by treatment
  geom_point(size = 3) + 
  facet_grid(sex~health_status) # create facets by sex and status</code></pre>
<p><img src="a-gentle-guide-to-tidy-statistics-in-r_files/figure-html5/unnamed-chunk-16-1.png" width="624" /></p>
</div>
<p>We can now see that the graph is properly sorted by drug treatment and by health status. We still have some work to do on the final graph, but let’s move on to the ANOVAs first!</p>
<h3 id="the-anova-finally">The ANOVA finally!</h3>
<p>We will be prepping a dataframe for analysis via ANOVA. We need to again make sure we have our factors as factors via mutate, and in the correct order. This is necessary for the ANOVA/post-hoc testing to work, and to make the post-hocs and the ANOVA outputs easier to read.</p>
<div class="layout-chunk" data-layout="l-body">
<pre><code>
Observations: 600
Variables: 5
$ age            &lt;int&gt; 80, 85, 82, 80, 83, 79, 82, 79, 80, 79, 80...
$ sex            &lt;fct&gt; Male, Male, Male, Male, Male, Male, Male, ...
$ health_status  &lt;fct&gt; Healthy, Healthy, Healthy, Healthy, Health...
$ drug_treatment &lt;fct&gt; Placebo, Placebo, Placebo, Placebo, Placeb...
$ mmse           &lt;dbl&gt; 24.78988, 24.88192, 25.10903, 24.92636, 23...</code></pre>
</div>
<hr />
<p>That gets our dataframe into working status!</p>
<p>Calling the ANOVA is a done via the aov function. The basic syntax is shown via pseudocode below. We put the dependent variable first (mmse in our case), then a ~ then the independent variable we want to test. Lastly we specify what data to use.</p>
<div class="layout-chunk" data-layout="l-body">

</div>
<p>We can add our real data set via the code below, but because we have 3 independent variables we have a choice to make. We can simply look for main effects by adding a + in between each of our variables, or we can look for both main effects and interactions by adding a <code>*</code> between each variable. Make sure to not replace the <code>+</code> or <code>*</code> with commas, as that will lead to an error.</p>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<hr />
<p>By assigning the ANOVA to the ad_aov object, we can then call <code>summary</code> on it to look at the results of the ANOVA.</p>
<div class="layout-chunk" data-layout="l-body">
<pre><code>
                                  Df Sum Sq Mean Sq  F value Pr(&gt;F)
sex                                1      0       0    0.047  0.828
drug_treatment                     2   3601    1801  909.213 &lt;2e-16
health_status                      1  10789   10789 5447.953 &lt;2e-16
sex:drug_treatment                 2      8       4    2.070  0.127
sex:health_status                  1      5       5    2.448  0.118
drug_treatment:health_status       2   2842    1421  717.584 &lt;2e-16
sex:drug_treatment:health_status   2      5       2    1.213  0.298
Residuals                        588   1164       2                
                                    
sex                                 
drug_treatment                   ***
health_status                    ***
sex:drug_treatment                  
sex:health_status                   
drug_treatment:health_status     ***
sex:drug_treatment:health_status    
Residuals                           
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<p>The summary gives us the degrees of freedom, sum of squares, mean squares, F value, and the p value. I added a bold emphasis on the &lt;2e -16, these p values are so small that R switches to scientific notation. So we see significant main effects of drug treatment, health status, and an interaction of drug treatment by health status. We can interpret that Alzheimer’s patients had different cognitive scores than healthy, and that drug treatment had an effect on cognitive scores. Importantly, sex was not a significant factor, as p = 0.828. Variables being scored as significant or non-significant can both be important!</p>
<p>We can also use <code>broom::tidy</code> to clean up the results of the ANOVA and put them into a dataframe. This is useful for storage, or for automation of some analysis for future ANOVAs.</p>
<div class="layout-chunk" data-layout="l-body">

</div>
<p>However, we don’t know the direction of differences, or where exactly the differences were Was it just the high dose? Low dose? Both? We need follow-up post hoc tests to determine these answers!</p>
<h3 id="post-hocs-post-docs-academia-jokes-dad-jokes">Post-hocs &gt; Post-docs (academia jokes &lt; dad jokes)</h3>
<p>We have multiple ways of looking at post-hocs. I will show two in this section.</p>
<p>For the pairwise, we need to use the <code>$</code> to select columns from each of the dataframes and look at the interaction via <code>:</code>. Our first pairwise has NO correction for multiple comparisons, and is comparable to a unprotected Fisher’s-LSD post-hoc. This is not stringent at all, and given the amount of comparisons we have it is advisable to either move forward with a p.adjusting Bonferonni correction (change <code>p.adj = “none”</code> to <code>p.adj = “bonf”</code>) or the Tukey post-hoc test seen in the next example. You can see that this method is a little jumbled to read due to the <code>dataset$column</code> method and the need for <code>:</code> in between each interaction. We can read this as we want pairwise.t.test for the interaction of sex by drug_treatment by health_status, which gives us every iteration of these factors against the other.</p>
<div class="layout-chunk" data-layout="l-body">

</div>
<p>Additionally, we need to extract the matrix of p values and save to an Excel file for future use.</p>
<p>We do this by simply wrapping our ad_last posthoc with <code>broom::tidy</code>.</p>
<div class="layout-chunk" data-layout="l-body">
<pre><code>
# A tibble: 6 x 3
  group1                     group2                 p.value
  &lt;chr&gt;                      &lt;chr&gt;                    &lt;dbl&gt;
1 Male:Placebo:Alzheimer&#39;s   Male:Placebo:Healthy 1.25e-199
2 Male:Low dose:Healthy      Male:Placebo:Healthy 9.84e-  1
3 Male:Low dose:Alzheimer&#39;s  Male:Placebo:Healthy 8.01e-157
4 Male:High Dose:Healthy     Male:Placebo:Healthy 5.09e-  3
5 Male:High Dose:Alzheimer&#39;s Male:Placebo:Healthy 3.11e- 10
6 Female:Placebo:Healthy     Male:Placebo:Healthy 9.69e-  1</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<hr />
<p>The Tukey post-hoc is a little cleaner to call, and is preferable to the unadjusted pairwise t-test. Notice we also are already wrapping the Tukey results in broom::tidy to save as a tidy dataframe! The TukeyHSD call incorporates the results of the ANOVA call, and is preferable to the previous method.</p>
<p>The following code can be read as we want a Tukey post-hoc test on the results of our ad_aov ANOVA across the interactions of sex by drug_treatment by health_status. Notice the quotation marks around ‘sex:drug_treatment:health_status’ and the : in between each variable. These are necessary to tell R how we want the Tukey to be run! Once this is done, R then runs tidy on it to make it into a nice dataframe similar to our previous pairwise test. We can then save the results to Excel!</p>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">
<table>
<thead>
<tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: left;">comparison</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">conf.low</th>
<th style="text-align: right;">conf.high</th>
<th style="text-align: right;">adj.p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">sex:drug_treatment:health_status</td>
<td style="text-align: left;">Female:Placebo:Healthy-Male:Placebo:Healthy</td>
<td style="text-align: right;">0.0111117</td>
<td style="text-align: right;">-0.9140819</td>
<td style="text-align: right;">0.9363052</td>
<td style="text-align: right;">1.0000000</td>
</tr>
<tr class="even">
<td style="text-align: left;">sex:drug_treatment:health_status</td>
<td style="text-align: left;">Male:Low dose:Healthy-Male:Placebo:Healthy</td>
<td style="text-align: right;">0.0056692</td>
<td style="text-align: right;">-0.9000907</td>
<td style="text-align: right;">0.9114291</td>
<td style="text-align: right;">1.0000000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sex:drug_treatment:health_status</td>
<td style="text-align: left;">Female:Low dose:Healthy-Male:Placebo:Healthy</td>
<td style="text-align: right;">0.0403184</td>
<td style="text-align: right;">-0.8748132</td>
<td style="text-align: right;">0.9554500</td>
<td style="text-align: right;">1.0000000</td>
</tr>
<tr class="even">
<td style="text-align: left;">sex:drug_treatment:health_status</td>
<td style="text-align: left;">Male:High Dose:Healthy-Male:Placebo:Healthy</td>
<td style="text-align: right;">0.7762410</td>
<td style="text-align: right;">-0.1295189</td>
<td style="text-align: right;">1.6820009</td>
<td style="text-align: right;">0.1775310</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sex:drug_treatment:health_status</td>
<td style="text-align: left;">Female:High Dose:Healthy-Male:Placebo:Healthy</td>
<td style="text-align: right;">0.4360609</td>
<td style="text-align: right;">-0.4790707</td>
<td style="text-align: right;">1.3511925</td>
<td style="text-align: right;">0.9213646</td>
</tr>
<tr class="even">
<td style="text-align: left;">sex:drug_treatment:health_status</td>
<td style="text-align: left;">Male:Placebo:Alzheimer’s-Male:Placebo:Healthy</td>
<td style="text-align: right;">-12.8040144</td>
<td style="text-align: right;">-13.7053250</td>
<td style="text-align: right;">-11.9027038</td>
<td style="text-align: right;">0.0000000</td>
</tr>
</tbody>
</table>
</div>
<h3 id="publication-graph">Publication Graph</h3>
<p>Now that we have generated our ANOVAs and post-hocs, and saved them to Excel for storage, we can start making a publication-grade graph!</p>
<p><code>ggplot2</code> graphs allow for extreme customization, some of the additions I make to this graph are a personal choice, and as such I would recommend discussion with a mentor or experienced member in your field. Bar graphs are ubiquitous in my field, and while I think plotting as a boxplot would tell more about the data, I will initially start with a bar graph.</p>
<p>Our goal is to plot the means, standard errors, and indicate significance where it occurs. Rather than relying on a package to label significance, I will be handmaking a custom dataframe with the tribble function. There are alternatives to doing it this way, but I can easily control what happens with this method, and it is explicitly apparent what the dataframe contains. The basics of tribble are shown in the below example. We assign columns with the ~ and then explicitly write out what we want in each row of the columns.</p>
<div class="layout-chunk" data-layout="l-body">
<pre><code>
# A tibble: 3 x 2
  colA   colB
  &lt;chr&gt; &lt;dbl&gt;
1 a         1
2 b         2
3 c         3</code></pre>
</div>
<p>And here is our actual code for making the custom dataframe.</p>
<div class="layout-chunk" data-layout="l-body">

</div>
<p>Now that we have this data frame, we can use it in a <code>geom_text</code> call to label our bars with significance labels as indicated by a <code>*</code>.</p>
<p>Here is what the final publication graph looks like in <code>ggplot2</code> code. You’ll notice I assigned it to <code>g1</code> rather than just calling it directly. This means I will have to call <code>g1</code> to view the graph, but I can save it now! To read what we are doing, I am calling the initial <code>ggplot</code> call as before, but adding an error bar layer, a bar graph layer, separating into panes for sex and health_status, switching to an alternate appearance (<code>theme_bw</code>), setting the colors manually, making minor adjustments via theme, adding the <code>*</code> for indication of significance, and lastly altering the axis labels while adding a figure caption.</p>
<div class="layout-chunk" data-layout="l-body">

</div>
<p>Saving is done via the ggsave function, where we will need to name the resulting file with surrounding “ “, tell R which ggplot object we want (g1), and indicate the size via height, width, and units. Don’t forget to save the graph with a dpi call to make it nice and crisp!</p>
<div class="layout-chunk" data-layout="l-body">

</div>
<p>And the final graph!</p>
<div class="layout-chunk" data-layout="l-body">
<p><img src="a-gentle-guide-to-tidy-statistics-in-r_files/figure-html5/unnamed-chunk-33-1.png" width="672" /></p>
</div>
<hr />
<p>I think it would be a disservice to say you can learn ggplot by simply recreating my example. As such, I would like to point you in the direction of the <a href="http://r4ds.had.co.nz/index.html">R for Data Science textbook</a>, as well as the <a href="http://moderndive.com/">Modern Dive ebook</a>. These free ebooks have a tremendous amount of information that may be beyond what you need to accomplish today, but would serve you well in your future endeavors. Their chapters on data visualization are very helpful for getting started in R plotting!</p>
<h2 id="thank-you">Thank you</h2>
<p><img src="https://i.imgur.com/1K9dnlg.gif" /></p>
<p>If you have made it this far, good for you! I hope this was helpful and if you have any questions, I would recommend reaching out on Twitter via the <code>#rstats</code> or <code>#r4ds</code> hashtag, or you can find me <span class="citation" data-cites="thomas_mock">@thomas_mock</span> on twitter.</p>
<p>Additionally, Jesse Maegan has a R for Data Science Slack channel where you can learn and ask questions as you work through the R for Data Science text, read all about it <a href="https://www.jessemaegan.com/post/r4ds-the-next-iteration/">here</a>!. R Studio (caretakers of the Tidyverse) hosts their own <a href="https://community.rstudio.com/">forums</a>.</p>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>


<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom"></div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
